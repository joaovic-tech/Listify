<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="shortcut icon" href="/assets/img/Logo.png">
  <link rel="stylesheet" href="/assets/styles/main.css" />
  <title>Edite seu perfil - Listify</title>
  <meta name="description" content="Perfil da sua conta Listify, Edite ou exclua sua conta">
  <script src="https://cdn.tailwindcss.com"></script>
  <script defer>
    tailwind.config = {
      darkMode: 'class',
    }
  </script>
  <script src="https://kit.fontawesome.com/673aed7dea.js" crossorigin="anonymous"></script>
  <style>
    html {
      overflow: hidden;
    }

    @media (max-width: 650px) {
      html {
        overflow: auto;
      }
    }
  </style>
</head>

<body id="profile" class="dark transition duration-500 ease-in-out flex flex-col justify-center items-center bg-gradient-to-b h-auto sm:h-screen gap-8 sm:gap-0">
  <div id="svg_background_dark" class="svg_background pointer-events-none h-screen animate-pulse"></div>

  <nav class="relative z-50 animate-nav flex items-center justify-between w-full h-auto p-2 bg-slate-100 dark:bg-gray-800 transition duration-500 ease-in-out shadow-md shadow-gray-300 dark:shadow-gray-900 rounded-b-lg">
    <div class="flex items-center">
      <i
        class="fa-solid fa-list-ul fill-current rounded-md px-3 py-3 bg-slate-200 dark:bg-gray-900 text-blue-500"></i>
      <p class="ml-4 text-lg font-semibold text-gray-800 dark:text-white">
        Meu perfil</span>
      </p>
    </div>
    <div class="relative">
      <button type="button" id="btn-settings"
        class="rounded-md bg-slate-200 dark:bg-gray-900 px-3 py-2 text-gray-500 hover:bg-slate-300 dark:hover:bg-gray-900 hover:text-blue-500">
        <i class="fa-solid fa-gear pointer-events-none"></i>
      </button>
      <ul id="menu-settings"
        class="opacity-0 pointer-events-none transition duration-500 ease-in-out absolute z-50 top-12 right-0 w-56 h-auto grid gap-2 p-2 rounded-b-lg justify-center items-center bg-slate-100 dark:bg-gray-800 text-base text-gray-800 dark:text-white">
        <li>
          <button id="theme-toggle"
            class="outline-0 flex justify-center items-center text-center gap-2 px-5 py-2 border-2 border-transparent transition ease hover:bg-slate-300 dark:hover:bg-gray-950 dark:hover:text-blue-600 hover:text-yellow-600 rounded dark:hover:border-blue-600 hover:border-yellow-600 rounded-lg cursor-pointer">
            <i id="theme-icon" class="fas fa-moon pointer-events-none"></i>
            Dark mode
          </button>
        </li>
        <li>
          <a href="/dashboard"
            class="outline-0 flex justify-center items-center text-center gap-2 px-5 py-2 border-2 border-transparent transition ease hover:bg-slate-300 dark:hover:bg-gray-950 hover:text-blue-500 hover:border-blue-500 rounded-lg cursor-pointer">
            <i class="fa-solid fa-arrow-left pointer-events-none"></i>
            Voltar
          </a>
        </li>
        <li>
          <a href="/login/logout"
            class="outline-0 flex justify-center items-center text-center gap-2 px-5 py-2 border-2 border-transparent transition ease hover:bg-slate-300 dark:hover:bg-gray-950 hover:text-rose-500 hover:border-rose-500 rounded-lg cursor-pointer">
            <i class="fas fa-sign-out-alt pointer-events-none"></i>
            Sair
          </a>
        </li>
      </ul>
    </div>
  </nav>

  <%- include('includes/messages'); %>
  
  <main class="flex items-center justify-between gap-2 w-screen h-screen">
    <section class="slide-in-left relative z-0 flex flex-col gap-8 justify-between items-center text-cente m-auto bg-white dark:bg-gray-700 p-8 p-2 w-full sm:w-11/12 h-auto transition duration-500 ease-in-out sm:rounded-lg">
      <div class="w-full sm:flex flex-col sm:flex-row justify-between items-center text-center">
        <form id="form-user-image" class="w-full sm:w-6/12 p-3 flex flex-col gap-4" action="/update/user/image/<%- user.id %>" method="post"
          enctype="multipart/form-data">
          <input type="text" name="username" id="username" value="<%- user.username %>" hidden />
          <input type="text" name="email" id="email" value="<%- user.email %>" hidden />
          <div class="flex justify-start items-center text-center gap-2">

            <% if(user.profile_picture) { %>
            <img src="<%- user.profile_picture %>" id="image" alt="Profile Image"
              class="w-24 h-24 rounded-full object-cover rounded-full shadow-md" />
            <% } else { %>
            <img src="/assets/svg/userImage.svg" id="image" alt="Profile Image"
              class="w-24 h-24 rounded-full object-cover rounded-full shadow-md" />
            <% } %>

            <div class="relative px-8 py-1 grid">
              <span class="text-2xl text-blue-600"><%- user.username %></span>
              <div
                class="absolute bottom-0 left-0 w-full h-1 rounded-full border-b-2 border-blue-600 shadow-md shadow-blue-600">
              </div>
            </div>
          </div>
          <div class="flex items-center justify-center w-full">
            <label for="profile_picture"
              class="flex flex-col items-center justify-center w-full h-64 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 dark:hover:bg-bray-800 dark:bg-gray-700 hover:bg-gray-100 dark:border-gray-500 dark:hover:border-gray-500 dark:hover:bg-gray-500">
              <div class="flex flex-col items-center justify-center pt-5 pb-6">
                <svg aria-hidden="true" class="w-10 h-10 mb-3 text-gray-400" fill="none" stroke="currentColor"
                  viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                </svg>
                <p class="mb-2 text-sm text-gray-500 dark:text-gray-400">
                  <span class="font-semibold">Clique para fazer upload </span>
                  ou arraste e solte.
                </p>
                <p class="text-xs text-gray-500 dark:text-gray-400">SVG, PNG, JPG/JPEG ou GIF - Até 1080x1080</p>
              </div>
              <input id="profile_picture" name="profile_picture" type="file" class="hidden" />
            </label>
          </div>
        </form>
        <form id="form-edit" class="space-y-4 md:space-y-6" action="/update/user/<%- user.id %>" method="post">
          <div>
            <label for="username"
              class="text-start block mb-2 text-sm font-medium text-gray-900 dark:text-white">Username</label>
            <input type="text" name="username" id="username"
              class="bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg outline-0 focus:ring-2 focus:ring-blue-600 focus:border-blue-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
              value="<%- user.username %>" autocomplete="true" />
          </div>
          <div>
            <label for="email"
              class="text-start block mb-2 text-sm font-medium text-gray-900 dark:text-white">E-mail</label>
            <input type="email" name="email" id="email"
              class="bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg outline-0 focus:ring-2 focus:ring-blue-600 focus:border-blue-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
              placeholder="exemplo@dominio.com" value="<%- user.email %>" autocomplete="true" />
          </div>
          <div class="relative">
            <span id="show-password"
              class="absolute bottom-2 right-2 text-base text-white transition hover:text-blue-600 focus:text-blue-600">
              <i class="fa-solid fa-eye-slash"></i>
            </span>
            <label for="password" class="text-start block mb-2 text-sm font-medium text-gray-900 dark:text-white">Nova
              senha</label>
            <input type="password" name="password" id="password" placeholder="••••••••"
              class="bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg outline-0 focus:ring-2 focus:ring-blue-600 focus:border-blue-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
              autocomplete="true" />
          </div>
          <div>
            <label for="confirm-password"
              class="text-start block mb-2 text-sm font-medium text-gray-900 dark:text-white">Confirme sua senha</label>
            <input type="password" name="confirmPassword" id="confirm-password" placeholder="••••••••"
              class="bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg outline-0 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
              autocomplete="true" />
          </div>
          <button type="submit"
            class="w-full text-white transition bg-blue-500 hover:bg-blue-700  focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-xl px-5 py-2.5 text-centerdark:focus:ring-blue-800">
            Salvar
          </button>
        </form>
      </div>
      <div class="w-full flex flex-col gap-2 sm:flex justify-between items-center text-center">
        <h2
          class="ml-3 px-8 py-1 bg-gradient-to-l dark:from-gray-800 dark:to-gray-900 from-white to-gray-300 text-blue-500 font-bold rounded-lg">
          <span class="text-xl font-semibold">Id:</span>
          <span class="text-base font-bold"><%- user.id %></span>
        </h2>
        <button
          class="btn-modal bg-red-600 text-white font-bold py-2 px-4 rounded transition hover:bg-red-800 focus:outline-none focus:shadow-outline">
          <i class="fas fa-trash-alt"></i> Apagar conta
        </button>

        <!-- Modal -->
        <div id="modal-delete"
          class="opacity-0 pointer-events-none transition duration-500 ease-in-out fixed z-10 inset-0 overflow-y-auto">
          <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
            <!-- Fundo do modal -->
            <div class="fixed inset-0 transition-opacity" aria-hidden="true">
              <div class="absolute inset-0 bg-gray-800 opacity-75"></div>
            </div>

            <!-- Conteúdo do modal -->
            <div
              class="inline-block align-bottom bg-slate-100 dark:bg-gray-950 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"
              role="dialog" aria-modal="true" aria-labelledby="modal-headline">
              <div class="bg-white dark:bg-gray-900 px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                <div class="sm:flex sm:items-start">
                  <div
                    class="flex text-center items-center justify-center h-12 w-12 rounded-full bg-slate-100 dark:bg-gray-700">
                    <!-- Ícone do modal -->
                    <i class="fas fa-exclamation-triangle text-red-600 text-2xl"></i>
                  </div>
                  <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left">
                    <h3 class="text-lg leading-6 font-medium text-red-600" id="modal-headline">Tem certeza que deseja
                      apagar sua conta?</h3>
                    <div class="mt-2">
                      <p class="text-sm text-gray-500">Esta ação não pode ser desfeita.</p>
                    </div>
                  </div>
                </div>
              </div>
              <div class="bg-gray-100 dark:bg-gray-700 px-4 py-3 gap-4 sm:px-6 sm:flex sm:flex-row-reverse">
                <form action="/delete/user/<%- user.id %>" class="flex justify-center ites-center" method="post">
                  <!-- Botão de submit do formulário -->
                  <button type="submit"
                    class="bg-red-600 text-white font-bold py-2 px-4 rounded transition hover:bg-red-800 focus:outline-none focus:shadow-outline">
                    <i class="fas fa-trash-alt"></i> Apagar conta
                  </button>
                </form>
                <!-- Botão de cancelar o modal -->
                <button type="button"
                  class="btn-modal mt-3 w-full sm:w-auto bg-gray-300 text-gray-700 font-bold py-2 px-4 rounded transition hover:bg-gray-400 focus:outline-none focus:shadow-outline sm:mt-0 sm:ml-3 sm:flex-shrink-0">
                  Cancelar
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <script>
    document.addEventListener('click', (e) => {
      const el = e.target;

      if (el.classList.contains('btn-modal')) {
        const modal = document.getElementById('modal-delete');
        modal.classList.toggle('show');
      }
    });
  </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/validator/13.9.0/validator.js"
    integrity="sha512-rOMALLrxlgIcEeMdX0O7A+pysTPb/201n7g04dPGvgJFB+f0CKvL8qljuIU/lDfG8IBi3o5R921G2013ihGuWg=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="/settings/DarkMode.js"></script>
  <script src="/settings/MenuSettings.js"></script>
  <script type="module" src="/settings/ProfileImage.js"></script>
  <script type="module" src="/utils/MessageServer.js"></script>
  <script type="module" src="/modules/User.js"></script>
</body>